# 🐔 Crossy Road | 过马路

经典的 3D 像素风格过马路游戏，使用 Three.js 打造逼真的 3D 场景，控制小鸡穿越繁忙的马路！

## 📖 游戏简介

这是一款基于 **Three.js** 开发的 3D 像素风格过马路游戏。玩家控制一只可爱的小鸡，需要穿越不断生成的马路、躲避来往的车辆和障碍物，走得越远分数越高。游戏采用正交相机视角，呈现独特的 3D 等距视觉效果，配合像素艺术风格，既复古又现代。

### 技术特点
- **Three.js 3D 渲染**：使用 WebGL 技术实现流畅的 3D 场景
- **正交相机视角**：等距视图，无透视变形
- **物理碰撞检测**：精确的车辆碰撞判定系统
- **动态场景生成**：无限延伸的关卡地图
- **像素艺术风格**：Press Start 2P 像素字体，复古游戏风格
- **本地存储**：自动保存最高分记录

## 🎮 游戏玩法

### 控制方式

#### 键盘操作（推荐）
- **⬆️ 上方向键**：向前移动（+1 分）
- **⬇️ 下方向键**：向后移动（-1 分）
- **⬅️ 左方向键**：向左移动（不计分）
- **➡️ 右方向键**：向右移动（不计分）
- **ESC 键**：关闭帮助弹窗

#### 触屏/鼠标操作
点击屏幕底部的方向控制按钮：
- **上箭头**：向前移动
- **下箭头**：向后移动
- **左箭头**：向左移动
- **右箭头**：向右移动

### 游戏目标
控制小鸡尽可能向前移动，穿越更多的马路和草地，躲避所有移动的车辆，挑战最高分记录。

### 计分规则
- **向前移动一格**：**+1 分**
- **向后移动一格**：**-1 分**
- **左右移动**：**不影响分数**
- **最低分数**：0 分（不会出现负分）
- **最高分自动保存**：存储在浏览器本地，刷新后仍然保留

### 游戏机制

#### 移动系统
- 每次按键移动一格（固定距离）
- 移动时有跳跃动画（正弦曲线轨迹）
- 移动时长 200 毫秒（`stepTime`）
- 相机跟随小鸡移动

#### 碰撞检测
- 游戏实时检测小鸡与车辆的碰撞
- 碰撞范围基于小鸡和车辆的实际尺寸
- **汽车长度**：60 单位
- **卡车长度**：105 单位
- **小鸡尺寸**：15 × 15 单位
- 一旦发生碰撞，游戏立即结束

#### 障碍物系统
游戏中存在两类障碍：
1. **移动障碍**：汽车和卡车，会在马路上左右移动
2. **固定障碍**：树木，在森林车道上随机分布，无法穿越

### 游戏元素

#### 地形类型
1. **🌿 草地（Grass/Field）**
   - 初始起点为草地
   - 安全区域，可以停留
   - 绿色平面，无障碍物

2. **🌳 森林（Forest）**
   - 草地上生成 4 棵随机分布的树木
   - 树木位置随机，不会重叠
   - 小鸡无法穿越树木，需要绕行
   - 树木高度随机（20/45/60 三种）

3. **🛣️ 马路（Road）**
   - 深灰色路面
   - 有车辆移动（汽车或卡车）
   - 危险区域，需快速通过

#### 车辆类型

1. **🚗 汽车（Car）**
   - 车身：60 × 30 × 15 单位
   - 车窗：带有窗户纹理
   - 车轮：前后两个黑色轮子
   - 每条汽车道有 3 辆车
   - 颜色：随机（红/黄/绿三种）

2. **🚚 卡车（Truck）**
   - 车身：100 × 25 × 5 单位
   - 货箱：75 × 35 × 40 单位（蓝色）
   - 驾驶室：25 × 30 × 30 单位
   - 车轮：前中后三个轮子
   - 每条卡车道有 2 辆卡车
   - 颜色：随机（红/黄/绿三种）

#### 车辆行为
- **移动方向**：每条车道随机决定（向左或向右）
- **移动速度**：随机（2.0 / 2.5 / 3.0 三种速度）
- **循环运动**：车辆到达边界后从另一侧重新出现
- **不同步**：每条车道的车辆速度和方向都独立

### 关卡生成
- **初始生成**：游戏开始时生成 10 条车道（索引 0-9）
- **动态扩展**：每次向前移动时，自动在前方添加新车道
- **随机类型**：新车道类型随机（car/truck/forest 三选一）
- **无限关卡**：理论上可以无限向前延伸

## 🖥️ 界面说明

### 顶部信息栏
位于屏幕顶部，半透明黑色渐变背景：

**左侧区域**
- **游戏标题**："Crossy Road"（像素字体）
- **小鸡图标**：🐔（带跳动动画）
- **帮助按钮**：❓ 圆形按钮，点击打开游戏说明

**右侧区域**
- **当前分数**
  - 标签："当前"（黄色）
  - 数值：实时更新的当前得分（白色）
  - 边框：黄色高亮
  
- **最高分数**
  - 标签："最高"（金色）
  - 数值：历史最高分（白色）
  - 边框：金色高亮

### 3D 游戏场景
占据整个屏幕，特点：

**视觉风格**
- **背景颜色**：天空蓝（#87ceeb）
- **相机角度**：倾斜 50°（俯视角度）
- **光照系统**：
  - 半球光：模拟天空和地面反射光
  - 定向光：跟随小鸡移动，产生阴影
  - 背景光：增强立体感

**场景元素**
- **小鸡**：白色方块身体 + 粉色鸡冠
- **草地**：亮绿色（#baf455）和深绿色（#99c846）
- **马路**：深灰色（#454a59）和浅灰色（#393d49）
- **树木**：棕色树干 + 绿色树冠
- **车辆**：带纹理的 3D 模型，有阴影效果

### 底部控制区
位于屏幕底部，方向键布局：

```
    [  ⬆️  ]
[⬅️] [⬇️] [➡️]
```

**按钮样式**
- 白色背景，深色边框
- 60 × 60 像素（移动端 50 × 50）
- 3D 按压效果（按下时下沉）
- 悬停时上浮 + 增强阴影

### 帮助说明弹窗
点击右上角 ❓ 按钮打开，内容包括：

**弹窗结构**
- **顶部标题**："📖 游戏说明"
- **关闭按钮**：× 符号（右上角，带旋转动画）
- **滚动内容区**：5 个章节
- **底部按钮**："开始游戏"（绿色）

**说明章节**
1. **🎮 游戏目标**：控制小鸡穿越马路，避开车辆
2. **⌨️ 控制方式**：键盘和按钮两种操作
3. **📊 计分规则**：前进加分，后退减分
4. **🌍 游戏元素**：草地、汽车、卡车说明
5. **💡 游戏技巧**：观察车速、利用草地、保持冷静

**视觉设计**
- 紫色渐变背景（#667eea → #764ba2）
- 金黄色边框和强调色
- 自定义滚动条（金黄色滑块）
- 滑入动画效果

### 游戏结束界面
碰到车辆时全屏显示：

**界面元素**
- **半透明黑色遮罩**：背景模糊效果
- **结束标题**：
  - 普通结束："🚫 游戏结束"（红色）
  - 新纪录："🎉 新纪录！"（红色）
- **最终得分**："最终得分: XX"（大号黄色数字）
- **重试按钮**："🔄 重新开始"（红色，带 3D 效果）

**触发条件**
- 小鸡与任何车辆发生碰撞
- 立即暂停游戏，显示结束界面
- 自动判断是否打破最高分记录

## 📱 响应式支持

游戏完全适配多种设备：

### 桌面设备（> 768px）
- 完整 UI 显示
- 较大的字体和按钮
- 推荐使用键盘操作

### 平板设备（≤ 768px）
- 缩小字体和图标
- 调整分数显示尺寸
- 控制按钮从 60px 缩小到 50px

### 手机设备（≤ 480px）
- 进一步压缩 UI 元素
- 游戏标题字体 1rem
- 帮助弹窗占据 95% 宽度
- 优化触控按钮间距

### 适配特性
- **弹性布局**：所有元素使用相对单位
- **触控优化**：足够大的按钮点击区域
- **自动缩放**：画布根据窗口大小自动调整
- **横竖屏支持**：两种方向均可正常游戏

## 🎨 视觉效果

### 配色方案
- **主色调**：紫色渐变（#667eea → #764ba2）
- **强调色**：金黄色（#FFC107）
- **危险色**：红色（#F44336）
- **成功色**：绿色（#4CAF50）

### 动画效果
1. **小鸡跳跃**：正弦曲线跳跃轨迹（每步 200ms）
2. **标题脉冲**：缩放动画（1.0 ↔ 1.05，2 秒周期）
3. **图标跳动**：小鸡图标上下跳动（5px，1 秒周期）
4. **按钮按压**：3D 下沉效果
5. **弹窗滑入**：从上方滑入 + 渐现
6. **关闭旋转**：关闭按钮旋转 90°

### 特殊效果
- **实时阴影**：车辆和小鸡投射动态阴影
- **毛玻璃背景**：顶部栏和弹窗使用 backdrop-filter
- **平滑移动**：相机跟随小鸡流畅移动
- **像素字体**：Press Start 2P，营造复古氛围

## 🚀 快速开始

### 运行游戏
1. 在浏览器中打开 `index.html` 文件
2. 确保网络连接（需要加载 Three.js CDN）
3. 点击屏幕或按方向键开始游戏

### 依赖项（CDN 加载）
- **Three.js r99**：3D 渲染引擎
- **Google Fonts**：Press Start 2P 像素字体

### 浏览器要求
- ✅ 支持 WebGL 的现代浏览器
- ✅ Chrome / Edge（推荐）
- ✅ Firefox
- ✅ Safari
- ⚠️ 需要启用 JavaScript 和 WebGL

### 性能要求
- **最低配置**：支持 WebGL 1.0 的设备
- **推荐配置**：独立显卡或集成显卡
- **帧率目标**：60 FPS

## 💡 游戏技巧

1. **观察车速**：在过马路前先观察车辆移动速度，选择合适时机
2. **利用草地**：草地是安全区域，可以停下来观察形势
3. **快速通过**：一旦进入马路，尽快移动到下一个安全区
4. **后退策略**：必要时可以后退避让车辆（虽然会扣分）
5. **注意树木**：森林车道中提前规划路线，避免被树木卡住
6. **预判位置**：根据车辆移动方向和速度，预判安全位置
7. **保持冷静**：不要急躁，每一步都要经过思考
8. **熟悉节奏**：多玩几次后会掌握车辆出现的节奏

## 🏆 挑战目标

根据得分划分难度等级：

- 🐣 **新手**：达到 10 分
- 🐥 **入门**：达到 25 分
- 🐤 **熟练**：达到 50 分
- 🐓 **专家**：达到 100 分
- 🦅 **大师**：达到 200 分
- 👑 **传奇**：达到 500 分
- 💎 **神话**：达到 1000 分

## 📄 文件结构

```
Crossy-Road/
├── index.html          # 游戏主页面（HTML 结构）
├── style.css           # 样式表（UI、动画、响应式）
├── script.js           # 游戏逻辑（Three.js、物理、碰撞检测）
└── README.md           # 本文档
```

## 🔧 技术细节

### 核心参数
```javascript
zoom: 2                    // 场景缩放比例
chickenSize: 15            // 小鸡尺寸
positionWidth: 42          // 每格宽度
columns: 17                // 总列数
boardWidth: 714            // 场景总宽度（42 × 17）
stepTime: 200              // 移动时长（毫秒）
```

### 相机设置
- **类型**：OrthographicCamera（正交相机）
- **旋转**：X=50°, Y=20°, Z=10°
- **位置**：动态跟随小鸡

### 渲染设置
- **渲染器**：WebGLRenderer
- **抗锯齿**：启用（antialias: true）
- **阴影**：PCFSoftShadowMap（软阴影）
- **刷新率**：requestAnimationFrame（60 FPS）

### 碰撞算法
使用 AABB（轴对齐包围盒）碰撞检测：
```
如果 (小鸡最大X > 车辆最小X) && (小鸡最小X < 车辆最大X)
  则发生碰撞
```

### 本地存储
```javascript
localStorage.setItem('crossyroad_highscore', score);
localStorage.getItem('crossyroad_highscore');
```

## 🐛 反馈与支持

### 常见问题

**Q: 游戏画面卡顿怎么办？**  
A: 尝试关闭其他占用 GPU 的程序，或降低浏览器硬件加速设置。确保显卡驱动为最新版本。

**Q: 为什么按键没反应？**  
A: 确保游戏界面处于焦点状态（点击画面），并且没有其他程序占用键盘。

**Q: 最高分会丢失吗？**  
A: 最高分保存在浏览器的 localStorage 中，除非清除浏览器数据，否则不会丢失。

**Q: 可以用触屏玩吗？**  
A: 可以！点击屏幕底部的方向按钮即可操作。

**Q: 车辆速度是固定的吗？**  
A: 不是，每条车道的车辆速度随机（2.0/2.5/3.0 三种），方向也随机（左或右）。

**Q: 为什么向后移动会扣分？**  
A: 这是游戏机制，鼓励玩家向前探索而不是后退。但紧急情况下后退避让是合理策略。

**Q: 游戏有终点吗？**  
A: 没有，游戏会无限生成新的车道，理论上可以一直玩下去。

### 已知问题
- 高分数时（如 1000+）可能出现轻微性能下降
- 极快速连续按键可能导致移动队列堆积
- 部分老旧设备可能无法流畅运行（需要 WebGL 支持）

### 性能优化建议
- 定期刷新页面以清理已生成的大量车道
- 关闭浏览器开发者工具以提升性能
- 使用桌面浏览器获得最佳体验

---

**准备好了吗？开始你的过马路冒险之旅！** 🐔🚗🌳
